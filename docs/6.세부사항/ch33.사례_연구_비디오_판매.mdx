---
sidebar_position: 4
---

# 33장 사례 연구: 비디오 판매

## 33-1. 제품

- 웹 사이트에서 비디오를 판매하는 소프트웨어(판매하길 원하는 비디오들이 개인과 기업에게 웹을 통해 판매한다.)
- 개인: 단품 가격을 지불해 스트리밍을 보거나 더 높은 가격을 내고 비디오를 다운로드해 영구 소장 가능
- 기업: 스트리밍 전용, 대량 구매하면 할인
- 비디오 제작자: 비디오 파일과 비디오에 대한 설명서, 부속 파일(시험, 문제, 해법, 소스 코드)을 제공
- 관리자: 신규 비디오를 추가하거나 기존 비디오를 추가 또는 삭제, 가격 책정
- 시스템의 초기 아키텍처를 결정하는 첫 단계는 액터와 유스케이스를 식별하는 일이다.

## 33-2. 유스케이스 분석

- 단일 책임 원칙에 따르면 네 액터는 시스템이 변경되어야 할 네 가지 주요 근원이 된다.
- 신규 기능을 추가하거나 기존 기능을 변경해야 한다면, 그 이유는 이 액터 중 하나에게 해당 기능을 제공하기 위해서이다.
- 시스템을 분할하여, 특정 액터를 위한 변경이 나머지 액터에게는 전혀 영향을 미치지 않게 만들고자 한다.
- 점선으로 된 유스케이스
  - 추상 유스케이스.
  - 범용적인 정책을 담고 있으며, 다른 유스케이스에서 이를 더 구체화
  - 이 추상 유스케이스를 다이어그램에서 없애더라도 전체 제품의 기능을 조금도 손상시키지 않는다.

## 33-3. 컴포넌트 아키텍처

- 이중으로 된 선
  - 아키텍처 경계
  - 뷰/프레젠터/인터랙터/컨트롤러 로 분리
  - 액터에 따라 카테고리를 분리
- 각 컴포넌트는 단일 .jar 파일 또는 단일 .dll파일에 해당. 이들 컴포넌트 각각은 자신에게 할당된 뷰, 프레젠터, 인터랙터, 컨트롤러를 포함
- 특수 컴포넌트
  - Catalog View, Catalog Presenter
  - 카탈로그 조회하기라는 추상 유스케이스를 처리하는 필자의 방식.
  - 뷰와 프레젠터는 해당 컴포넌트 내부에서 추상 클래스로 코드화
  - 상속받는 컴포넌트에서는 이들 추상 클래스로부터 상속받은 뷰와 프레젠터 클래스를 포함
- 시스템을 이 컴포넌트로 분할해서 여러개의 .jar나 .dll파일로 전달해야할 수도 있고 아닐 수도 있다.
- 뷰, 프레젠터, 인터랙터, 컨트롤러, 유틸리티 각각을 하나의 .jar파일로 만들어,
  서로 독립적으로 변경될 가능성이 큰 컴포넌트들을 독립적으로 배포할 수 있게도 된다.
- 뷰와 프레젠터를 합쳐서 같은 .jar에 두고 인터렉터, 컨트롤러, 유틸리티는 그대로 개별 .jar파일에 두는 방식도 있다.
- 더 원시적으로 두 개의 .jar 파일을 생성해서, 하나에는 뷰와 프레젠터를, 다른 하나에는 나머지 모두를 포함시키는 방법도 있다.
- **선택지를 열어 두면, 후에 시스템이 변경되는 야상에 맞춰 시스템 배포 방식을 조정할 수 있다.**

## 33-4. 의존성 관리

- 제어흐름은 오른쪽에서 왼쪽으로 이동.
- 입력이 컨트롤러에서 발생하면 인터랙터에 의해 처리되어 결과가 만들어진다.
- 그 후 프레젠터가 결과의 포맷을 변경하고 뷰가 화면에 표시한다.
- 하지만, 모든 화살표가 오른쪽에서 왼쪽을 가리키지는 않는다.
- 대다수의 화살표는 왼쪽에서 오른쪽으로 향한다..
  - 아키텍처가 의존성 규칙을 준수하기 때문
  - 모든 의존성은 경계선을 한 방향으로만 가로지르는데, 항상 더 높은 수준의 정책을 포함하는 컴포넌트를 향한다.
- 사용 관계(열린 화살표)는 제어흐름과 같은 방향을 가리키며, 상속 관계(닫힌 화살표)는 제어흐름과는 반대 방향을 가리킨다.
  - 개방 폐쇄 원칙을 적용
- 의존성이 올바른 방향으로 흐르며, 저수준의 세부사항에서 발생한 변경위 상위로 파급되어 상위 수준의 정책에 영향을 미치지 않음을 보장한다.

## 33-5. 결론

- 단일 책임 원칙에 기반한 액터의 분리, 의존성 규칙을 포함한다.
- 두 방법은 모두 서로 다른 이유로, 서로 다른 속도로 변경되는 컴포넌트를 분리하는 데 목적이 있다.
  - 서로 다른 이유라는 것은 액터와 관련
  - 서로 다른 속도라는 것은 정책 수준과 관련
- 이런 방식으로 코드를 구조화하면 시스템 배포는 상황에 맞게 다양하게 선택할 수 있게 된다.
