---
sidebar_position: 2
---

# 8장 개방-폐쇄 원칙

💡 **개방-폐쇄 원칙 (OCP: Open-Closed princiiple)** 1988년 버트란트 마이어*반드시 새로운 코드를 추가하는 방식*.
시스템의 행위를 변경할 수 있도록 설계해야만 소프트웨어 시스템을 쉽게 변경할 수 있다.

---

## 8-1. infro

- _소프트웨어 개체는 확장에는 열려 있어야 하고, 변경에는 닫혀 있어야 한다._
- 즉, 소프트웨어 객체의 행위는 확장할 수 있어야 하지만, 이때 객체를 변경해서는 안된다.
- 작은 요구사항을 확장하는 데 소프트웨어 수정이 많다 -> 실패한 아키텍트
- OCP 클래스와 모듈을 설계할 때 도움되는 원칙이라고 알고 있다.
- 아키텍처 컴포넌트 수준에서 OCP를 고려할 때가 더 중요한 의미를 가진다.

## 8-2. [예시] 재무제표 웹 시스템

### 8-2-1. 사고 실험

- 웹 페이지에 표시되는 데이터는 스크롤 가능 -> 음수는 빨간색으로 출력
- 이해관계자가 동일한 정보를 보고서 형태로 변환해서 흑백 프린터로 출력을 요청
  - 페이지 번호
  - 페이지별 머리글과 바닥글
  - 표의 각 열에는 레이블이 존재
  - 음수는 괄호
- 소프트웨어 아키텍처가 훌륭 -> 변경되는 코드의 양이 최소화, 이상적인 변경량은 0
- 변경량을 최소화 하는 방법
  - 서로 다른 목적으로 변경되는 요소를 적절하게 분리(단일 원칙 책임)
  - 이들 요소 사이의 의존성을 체계화(의존성 역전 원칙)
- 단일 원칙 책임 적용의 데이터 흐름
  - [ 재무 데이터 ] - ( 재무 분석기 ) - [ 보고서용 재무 데이터 ] - ( 보고서를 웹에 표시 ) or ( 보고서를 프린터로 출력 )
    1. 재무 데이터를 검사
    2. 보고서용 데이터를 생성
    3. 필요에 따라 두 가지 보고서 생성 절차 중 하나를 거쳐 적절히 포매팅
  - 보고서 생성이 두 개의 책임으로 분리
    - 보고서용 데이터를 계산
    - 데이터를 웹, 프린트하기에 적합한 형태로 표현
  - 두 책임 중 하나에서 변경이 발생하더라도 다른 하나는 변경되지 않도록 소스 코드 의존성도 조직화가 필요
  - 조직화한 구조에서는 행위가 확장될 때 변경이 발생하지 않음을 보장
  - 목적 달성을 위해
    - 처리 과정을 클래스 단위로 분할
    - 클래스를 []로 표시한 컴포넌트 단위로 구분
- 본책 그림 8.2, 8.3 참고 (P.76-77)
  - 모든 컴포넌트 관계는 단방향
  - 변경으로부터 보호하기 위해 컴포넌트 구조, 흐름이 중요
  - interation
    - 다른 모든 것에서 발생한 변경으로부터 보호
    - OCP를 잘 준수할 수 있는 곳에 위치
      - database, controller, presenter, view에서 발생한 어떤 변경도 interator는 영향을 주지 않는다.
      - interactor가 업무 규칙을 포함하기 때문
      - 애플리케이션의 가장 높은 수준의 정책을 포함
    - interactor 이외의 컴포넌트는 주변적인 문제를 처리
    - interactor는 가장 중요한 문제를 처리
- 정리
  - 보호의 계층구주가 수준이라는 개념을 바탕으로 어떻게 생성되었는지 주목
  - 아키텍트는 기능이 어떻게, 왜, 언제 발생하는지에 따라서 기능을 분리
  - 분리한 기능을 컴포넌트 계층구조로 조직화
  - 조직화는 저수준 컴포넌트에서 발생한 변경으로 부터 고수준 컴포넌트를 보호

### 8-2-2. 방향성 제어

- 컴포넌트 간 의존성의 방향이 중요
- 인터페이스가 없으면 의존성이 고수준의 바로 향하게 되기 때문에 방향성이 중요

### 8-2-3. 정보 은닉

- 고수준 내부에 대해 너무 많이 알지 못하도록 제어하기 위해서 존재하는 인터페이스도 존재
- 이러한 인터페이스가 없다면, 추이 종속성을 가지게 되는 경우가 있다.
- 추이 종속성이 생기면
  - 자신이 직접 사용하지 않는 요소에는 절대로 의존해서는 안 된다 의 원칙을 위반

### 8-2-4. 결론

- OCP는 시스템 아키텍처의 원동력 중 하나
- 시스템을 확장하기 쉬운 동시에 변경으로 인해 시스템이 너무 많인 영향을 받지 않아야 한다.
- 시스템을 컴포넌트 단위로 분리
- 저수준 컴포넌트에서 발생한 변경으로부터 고수준 컴포넌트를 보호할 수 있는 형태의 의존성 계층구조를 구축
